<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Chapter 1- Basic Commands and Info</title>
    <link rel="stylesheet" href="/assets/scss/git-wiki-style.css">
  </head>
  <body>
    <nav>
      <a href="/">Home</a>
    </nav>
    <div class="main-section">
      <p><a href="/dev-tech/docker">GOTO Docker Home</a> –</p>

<h2 id="chapter-1---basic-commands-and-info">Chapter 1 - Basic Commands and Info</h2>

<p>To search docker registry for an image</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker search busybox
</code></pre></div></div>

<p>To see what docker images are already present locally (note that this is <b>NOT</b> equal to container name which we give while running/saving containers)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker images
</code></pre></div></div>

<p>This is the output</p>
<pre>
REPOSITORY                TAG                 IMAGE ID            CREATED             SIZE
node                      9.6.1-stretch       f88afee950ae        7 days ago          891MB
ubuntu                    16.04               0458a4468cbc        5 weeks ago         112MB
hello-world               latest              f2a91732366c        3 months ago        1.85kB
markadams/chromium-xvfb   latest              44cb7db1a745        6 months ago        543MB
node                      6.9.2-wheezy        a4520758fe5e        14 months ago       507MB
</pre>

<p>To free up space on your machine, remove local images no longer in use by this</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker rmi <span class="o">{</span>image-id<span class="o">}</span>
</code></pre></div></div>

<p>To show a list of currently running docker containers</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker ps
</code></pre></div></div>

<p>To show last run container</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker ps <span class="nt">-l</span>
</code></pre></div></div>

<p>To show last <code class="highlighter-rouge">k</code> run containers (doesn’t show the deleted ones)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker ps <span class="nt">-n</span> 2
</code></pre></div></div>
<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker ps <span class="nt">-n</span> 3
</code></pre></div></div>
<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker ps <span class="nt">-n</span> <span class="o">{</span>k<span class="o">}</span>
</code></pre></div></div>

<p>To show all the previously run containers so far (doesn’t show the deleted ones)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker ps <span class="nt">-a</span>
</code></pre></div></div>

<p>To create and run a docker container. <code class="highlighter-rouge">-name</code> flag assigns the container a name. <code class="highlighter-rouge">ubuntu:16.04</code> is the image name in the docker official repository. <code class="highlighter-rouge">-it</code> are the flags for interactive and tty. <code class="highlighter-rouge">/bin/bash</code> is the command which will be run inside the container. The docker container runs as long as the program inside it is running.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--name</span> pipeline <span class="nt">-it</span> ubuntu:16.04 /bin/bash
</code></pre></div></div>

<p>To create and run a docker container in detached mode, simply pass the <code class="highlighter-rouge">-d</code> flag. This creates and starts the container and returns back to the terminal of the host os</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--name</span> pipeline <span class="nt">-idt</span> ubuntu:16.04 /bin/bash
</code></pre></div></div>

<p>Port Mapping in docker containers. Port Mapping in docker containers has to happen when the container is created. For example, the below command does port mapping from 805 to 805.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--name</span> pipeline <span class="nt">-idt</span> <span class="nt">-p</span> 805:805 ubuntu:16.04 /bin/bash
</code></pre></div></div>

<p>Now, if you try <code class="highlighter-rouge">docker ps</code> command, you will see the following output in the ports column:</p>

<pre>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                  NAMES
44859c860bd2        ubuntu:16.04        "/bin/bash"         4 seconds ago       Up 3 seconds        0.0.0.0:805-&gt;805/tcp   pipeline
</pre>

<p>To delete a container (pass the container id in the string)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker rm <span class="s2">"ebe464aec5f1cc882f839a596f5c1ba360b56bc7b460a34985108aff71da5550"</span>
</code></pre></div></div>
<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker rm <span class="o">{</span>container-name<span class="o">}</span>
</code></pre></div></div>

<h3 id="resuming-your-work-again-in-the-containers">Resuming your work again in the containers</h3>

<ul>
  <li>[Ref A] To start up and enter into the terminal of an existing container which you <code class="highlighter-rouge">exited</code> from</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker start <span class="nt">-i</span> pipeline
</code></pre></div></div>
<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker start <span class="nt">-i</span> <span class="o">{</span>container-name<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>[Ref B] Let’s say you used above command to enter into the container again. Now this container is running as long as you don’t exit from it. Now, in another tab, if you want another terminal session into the container, you can run:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">exec</span> <span class="nt">-it</span> pipeline /bin/bash
</code></pre></div></div>
<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="o">{</span>container-name<span class="o">}</span> /bin/bash
</code></pre></div></div>

<p>How does the command <code class="highlighter-rouge">Ref A</code> differ from the command <code class="highlighter-rouge">Ref B</code>? Well, if you type <code class="highlighter-rouge">exit</code> while in the session of <code class="highlighter-rouge">Ref A</code>, the session in <code class="highlighter-rouge">Ref B</code> automatically terminates. However, the vice versa is not true. Hence, the command in <code class="highlighter-rouge">Ref B</code> can be accurately describes as a means to <strong>connect and lauunch as schell script to an existing running container</strong></p>

<p>Thw below command simply executes the <code class="highlighter-rouge">ifconfig</code> command inside container <code class="highlighter-rouge">pipeline</code> and returns the output in the host terminal</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">exec </span>pipeline ifconfig
</code></pre></div></div>

<p>To rename the docker container</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker rename pipeline pipeline2
</code></pre></div></div>

<p>Freeze all processes and resources for a container</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker pause pipeline2
</code></pre></div></div>

<p>Unfreeze/Unpause a freezed container</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker unpause pipeline2
</code></pre></div></div>

<p>To view all images and containers being used across the system</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker system df
</code></pre></div></div>
<p>Output:</p>
<pre>
TYPE                TOTAL               ACTIVE              SIZE                RECLAIMABLE
Images              5                   2                   2.054GB             1.942GB (94%)
Containers          2                   1                   56.29MB             0B (0%)
Local Volumes       0                   0                   0B                  0B
Build Cache                                                 0B                  0B
</pre>

<p>To prune the system of docker containers</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker system prune
</code></pre></div></div>

<p>Output:</p>
<pre>
WARNING! This will remove:
      - all stopped containers
      - all networks not used by at least one container
      - all dangling images
      - all build cache
Are you sure you want to continue? [y/N]
</pre>

<p>To see the processes running inside a container, type the following command from the host system’s terminal</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker top pipeline
</code></pre></div></div>
<p>Output:</p>
<pre>
UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD
root                12818               12802               0                   20:24               pts/0               00:00:00            /bin/bash
</pre>

<h4 id="stdinstdout">STDIN/STDOUT</h4>
<p>What is STDIN/STDOUT?
Simply put, it will redirect you input commands to the process and display the output back from there to the terminal. For example, pressing <code class="highlighter-rouge">Enter</code> would be send as an input to the primary process which is running, and the output from that process will be shown back to you. In most cases, it’s <strong>important that the main program you wish to run, runs in the foreground always</strong></p>

<p>To attach STDIN/STDOUT to the primary program that is running, run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker attach pipeline
</code></pre></div></div>

<p>To fetch the logs of a docker container</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker logs pipeline
</code></pre></div></div>
<p>This will provide you history of the commands run, their output, etc.</p>

<p>To inspect a docker container, i.e., get the full picture of the container, run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker inspect pipeline
</code></pre></div></div>
<p>This will give you a json output giving a full description about the container. Here is a sample output:</p>
<pre>
[
  {
      "Id": "44859c860bd2ae9d187afe680e5fba67f16df70129206af962348133324caf76",
      "Created": "2018-03-03T14:54:59.189865706Z",
      "Path": "/bin/bash",
      "Args": [],
      "State": {
          "Status": "exited",
          "Running": false,
          "Paused": false,
          "Restarting": false,
          "OOMKilled": false,
          "Dead": false,
          "Pid": 0,
          "ExitCode": 0,
          "Error": "",
          "StartedAt": "2018-03-03T14:54:59.504665511Z",
          "FinishedAt": "2018-03-03T15:17:28.446851212Z"
      },
      "Image": "sha256:0458a4468cbceea0c304de953305b059803f67693bad463dcbe7cce2c91ba670",
      "ResolvConfPath": "/var/lib/docker/containers/44859c860bd2ae9d187afe680e5fba67f16df70129206af962348133324caf76/resolv.conf",
      "HostnamePath": "/var/lib/docker/containers/44859c860bd2ae9d187afe680e5fba67f16df70129206af962348133324caf76/hostname",
      "HostsPath": "/var/lib/docker/containers/44859c860bd2ae9d187afe680e5fba67f16df70129206af962348133324caf76/hosts",
      "LogPath": "/var/lib/docker/containers/44859c860bd2ae9d187afe680e5fba67f16df70129206af962348133324caf76/44859c860bd2ae9d187afe680e5fba67f16df70129206af962348133324caf76-json.log",
      "Name": "/pipeline",
      "RestartCount": 0,
    ...........................
......................
]
</pre>

<p>To get realtime stats about things like network I/O, memory usage etc., run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker stats
</code></pre></div></div>

<pre>
CONTAINER ID        NAME                CPU %               MEM USAGE / LIMIT   MEM %               NET I/O             BLOCK I/O           PIDS
44859c860bd2        pipeline            0.00%               468KiB / 15.55GiB   0.00%               6.53kB / 0B         0B / 0B             1
</pre>

<p>To copy files from the host machine to the container, you can run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker cp <span class="o">{</span>path-to-file-from-host-machine<span class="o">}</span> <span class="o">{</span>container-name<span class="o">}</span>:<span class="o">{</span>path-to-dir-to-copy-to<span class="o">}</span>
</code></pre></div></div>

<hr />

<p><a href="/dev-tech/docker/chapter-2">GOTO Chapter 2</a></p>

    </div>
  </body>
</html>